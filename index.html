<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>STEPS FETP Scale Up Decision Aid</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="styles.css">

    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
    <!-- jsPDF -->
    <script src="https://cdn.jsdelivr.net/npm/jspdf@2.5.1/dist/jspdf.umd.min.js"></script>
    <!-- SheetJS for Excel export -->
    <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
</head>
<body>
<header class="app-header">
    <div class="app-header-left">
        <div class="app-logo-circle">S</div>
        <div>
            <h1 class="app-title">STEPS</h1>
            <p class="app-subtitle">Scalable Training Estimation and Planning System for FETP India</p>
        </div>
    </div>
    <div class="app-header-right">
        <span class="badge-primary">Policy decision aid</span>
        <span class="badge-outline">Version 1.0</span>
    </div>
</header>

<main class="app-shell">
    <nav class="tab-bar">
        <button class="tab-link active" data-tab="intro">Introduction</button>
        <button class="tab-link" data-tab="attributes">Attributes</button>
        <button class="tab-link" data-tab="config">Configuration</button>
        <button class="tab-link" data-tab="results">Results</button>
        <button class="tab-link" data-tab="costing">Costing details</button>
        <button class="tab-link" data-tab="scenarios">Saved scenarios</button>
        <button class="tab-link" data-tab="about">About STEPS</button>
        <button class="tab-link" data-tab="technical">Technical appendix</button>
    </nav>

    <!-- INTRO TAB -->
    <section id="tab-intro" class="tab-panel active">
        <div class="grid-two">
            <div class="card">
                <h2>What STEPS does</h2>
                <p>
                    STEPS helps policy makers and partners explore different options for scaling Field Epidemiology
                    Training Programs (FETPs) in India. It links three main inputs:
                </p>
                <ul class="plain-list">
                    <li>Preferences from a discrete choice experiment with 214 senior stakeholders.</li>
                    <li>Detailed costing templates from WHO, NIE and NCDC for Frontline, Intermediate and Advanced FETPs.</li>
                    <li>Simple epidemiological multipliers that translate training scale up into public health benefits.</li>
                </ul>
                <p>
                    Users can set a programme configuration, see expected endorsement rates, costs and benefit
                    cost ratios, and compare saved scenarios side by side for business case discussions.
                </p>
            </div>
            <div class="card">
                <h2>How to use the tool</h2>
                <ol class="plain-list numbered">
                    <li>Go to the <strong>Configuration</strong> tab and choose programme tier, mentorship,
                        response time, delivery mode, number of cohorts, cohort size and cost per trainee per month.
                    </li>
                    <li>Keep the cost slider within the range used in the experiment (75,000 to 400,000 rupees per trainee per month).</li>
                    <li>Select the preference model: average mixed logit or the supportive latent class group.</li>
                    <li>Click <strong>Apply configuration</strong> and <strong>View results</strong> to see a modal
                        summary with headline recommendations.
                    </li>
                    <li>Save promising scenarios in the <strong>Saved scenarios</strong> tab, and download them to
                        Excel or as a policy brief PDF for World Bank reporting.
                    </li>
                </ol>
                <p class="note">
                    STEPS is designed for laptops, desktops, tablets and mobiles. It can be used live in workshops
                    with central and state level partners.
                </p>
            </div>
        </div>
    </section>

    <!-- ATTRIBUTES TAB -->
    <section id="tab-attributes" class="tab-panel">
        <div class="card">
            <h2>Attributes and levels in the FETP DCE</h2>
            <p>
                The discrete choice experiment asked respondents to choose between two FETP training options
                and an opt out. Each training option was defined by the attributes below. These descriptions
                are written in simple terms for policy audiences.
            </p>
            <div class="attributes-grid">
                <div class="attr-card">
                    <h3>Programme tier</h3>
                    <p>
                        The depth and duration of training. Frontline is short and basic. Intermediate is
                        longer and part time. Advanced is a full fellowship.
                    </p>
                    <ul class="plain-list">
                        <li><strong>Frontline</strong>: about three months, focused on basic surveillance tasks.</li>
                        <li><strong>Intermediate</strong>: around twelve months, usually while staff stay in post.</li>
                        <li><strong>Advanced</strong>: two year fellowship for national and state level epidemiologists.</li>
                    </ul>
                </div>
                <div class="attr-card">
                    <h3>Career incentives</h3>
                    <p>
                        The formal recognition and career consequences of completing FETP.
                    </p>
                    <ul class="plain-list">
                        <li><strong>Government and partner certificate</strong> (reference option).</li>
                        <li><strong>University qualification</strong> such as a diploma or degree.</li>
                        <li><strong>Government career pathway</strong> with clearer promotion prospects.</li>
                    </ul>
                </div>
                <div class="attr-card">
                    <h3>Mentorship intensity</h3>
                    <p>
                        How much support trainees receive from experienced epidemiologists.
                    </p>
                    <ul class="plain-list">
                        <li><strong>Low mentorship</strong> (reference): limited one to one support.</li>
                        <li><strong>Medium mentorship</strong>: regular support and feedback.</li>
                        <li><strong>High mentorship</strong>: close supervision and frequent field guidance.</li>
                    </ul>
                </div>
                <div class="attr-card">
                    <h3>Mode of delivery</h3>
                    <p>
                        How teaching and supervision are delivered to trainees.
                    </p>
                    <ul class="plain-list">
                        <li><strong>Blended</strong> (reference): mix of face to face and online sessions.</li>
                        <li><strong>Fully in person</strong>: training and mentoring mainly on site.</li>
                        <li><strong>Fully online</strong>: training delivered virtually.</li>
                    </ul>
                </div>
                <div class="attr-card">
                    <h3>Response capacity</h3>
                    <p>
                        How quickly the system is expected to respond to a public health event.
                    </p>
                    <ul class="plain-list">
                        <li><strong>Within 30 days</strong> (reference).</li>
                        <li><strong>Within 15 days</strong>.</li>
                        <li><strong>Within 7 days</strong>.</li>
                    </ul>
                </div>
                <div class="attr-card">
                    <h3>Cost per trainee per month</h3>
                    <p>
                        Total programme cost per trainee per month. In the experiment this varied from
                        75,000 to 400,000 rupees per trainee per month. STEPS keeps the slider within this
                        range to ensure that outputs remain inside the values used in the model.
                    </p>
                </div>
            </div>
            <p class="note">
                In the mixed logit and latent class models, Training B is the reference training option.
                The alternative specific constant for Training A captures any left right layout effect.
                The alternative specific constant for the opt out captures a general tendency to reject
                both training options. STEPS uses the opt out constant when predicting overall endorsement
                of any FETP option versus no FETP.
            </p>
        </div>
    </section>

    <!-- CONFIG TAB -->
    <section id="tab-config" class="tab-panel">
        <div class="grid-two-stretch">
            <div class="card">
                <h2>Configure an FETP scale up option</h2>
                <div class="form-grid">
                    <div class="form-group">
                        <label for="program-tier">Programme tier</label>
                        <select id="program-tier">
                            <option value="frontline">Frontline (3 months)</option>
                            <option value="intermediate">Intermediate (12 months)</option>
                            <option value="advanced">Advanced (24 months)</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="career-track">Career incentive</label>
                        <select id="career-track">
                            <option value="certificate">Government and partner certificate</option>
                            <option value="uniqual">University qualification</option>
                            <option value="career_path">Government career pathway</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="mentorship">Mentorship intensity</label>
                        <select id="mentorship">
                            <option value="low">Low mentorship</option>
                            <option value="medium">Medium mentorship</option>
                            <option value="high">High mentorship</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="delivery">Mode of delivery</label>
                        <select id="delivery">
                            <option value="blended">Blended</option>
                            <option value="inperson">Fully in person</option>
                            <option value="online">Fully online</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="response">Expected response time for events</label>
                        <select id="response">
                            <option value="30">Within 30 days</option>
                            <option value="15">Within 15 days</option>
                            <option value="7">Within 7 days</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="cost-slider">
                            Cost per trainee per month (<span id="currency-label">INR</span>)
                        </label>
                        <input type="range" id="cost-slider" min="75000" max="400000" step="5000" value="250000">
                        <div class="slider-value">
                            <span id="cost-display">INR 250,000</span>
                            <span class="slider-hint">
                                Within the range used in the discrete choice experiment (75,000 to 400,000 rupees).
                            </span>
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="trainees">Trainees per cohort</label>
                        <input type="number" id="trainees" min="5" max="60" value="20">
                    </div>

                    <div class="form-group">
                        <label for="cohorts">Number of cohorts</label>
                        <input type="number" id="cohorts" min="1" max="100" value="10">
                    </div>

                    <div class="form-group">
                        <label>Preference model</label>
                        <div class="pill-toggle-group">
                            <button type="button" class="pill-toggle active" data-model="mxl">
                                Average mixed logit
                            </button>
                            <button type="button" class="pill-toggle" data-model="lc2">
                                Supportive group (latent class)
                            </button>
                        </div>
                        <p class="hint">
                            The supportive group uses the Class 2 parameters from the latent class model.
                        </p>
                    </div>

                    <div class="form-group">
                        <label>Currency display</label>
                        <div class="pill-toggle-group">
                            <button type="button" class="pill-toggle active" data-currency="INR">
                                INR (calculations)
                            </button>
                            <button type="button" class="pill-toggle" data-currency="USD">
                                Approximate USD
                            </button>
                        </div>
                        <p class="hint">
                            All calculations are in INR. USD values use a simple exchange rate for display only.
                        </p>
                    </div>

                    <div class="form-group">
                        <label>Include opportunity cost of trainee time</label>
                        <button type="button" id="opp-toggle" class="switch-pill on">
                            <span class="switch-knob"></span>
                            <span class="switch-label">Opportunity cost included</span>
                        </button>
                        <p class="hint">
                            Where the cost template has opportunity cost, this option adds it to economic costs.
                        </p>
                    </div>

                    <div class="form-group form-group-wide">
                        <label for="scenario-name">Scenario name</label>
                        <input type="text" id="scenario-name" placeholder="For example: Advanced high mentorship 20 cohorts">
                    </div>

                    <div class="form-group form-group-wide">
                        <label for="scenario-notes">Scenario notes</label>
                        <textarea id="scenario-notes" rows="3"
                                  placeholder="Optional notes to support the World Bank business case and the STEPS report."></textarea>
                    </div>
                </div>

                <div class="button-row">
                    <button id="update-results" class="btn-primary">Apply configuration</button>
                    <button id="open-snapshot" class="btn-secondary">View results</button>
                    <button id="save-scenario" class="btn-ghost">Save scenario</button>
                </div>
            </div>

            <div class="card card-secondary">
                <h2>Current configuration at a glance</h2>
                <div id="config-summary" class="config-summary">
                    <!-- Filled by script -->
                </div>
                <hr class="divider">
                <h3>Headline recommendation</h3>
                <p id="headline-recommendation" class="headline-text">
                    Apply a configuration to see a concise recommendation.
                </p>
            </div>
        </div>
    </section>

    <!-- RESULTS TAB -->
    <section id="tab-results" class="tab-panel">
        <div class="grid-three">
            <div class="card">
                <h2>Endorsement and opt out</h2>
                <div class="metric-pair">
                    <div>
                        <span class="metric-label">Endorse FETP option</span>
                        <span class="metric-value" id="endorsement-rate">-</span>
                    </div>
                    <div>
                        <span class="metric-label">Choose opt out</span>
                        <span class="metric-value" id="optout-rate">-</span>
                    </div>
                </div>
                <div class="chart-block">
                    <canvas id="chart-uptake"></canvas>
                </div>
            </div>

            <div class="card">
                <h2>Costs and benefits per cohort</h2>
                <div class="metric-pair">
                    <div>
                        <span class="metric-label">Total economic cost</span>
                        <span class="metric-value" id="total-cost">-</span>
                    </div>
                    <div>
                        <span class="metric-label">Net benefit</span>
                        <span class="metric-value" id="net-benefit">-</span>
                    </div>
                </div>
                <div class="metric-single">
                    <span class="metric-label">Benefit cost ratio</span>
                    <span class="metric-value" id="bcr">-</span>
                </div>
                <div class="chart-block">
                    <canvas id="chart-bcr"></canvas>
                </div>
            </div>

            <div class="card">
                <h2>Epidemiological implications</h2>
                <div class="metric-pair">
                    <div>
                        <span class="metric-label">FETP graduates (all cohorts)</span>
                        <span class="metric-value" id="epi-graduates">-</span>
                    </div>
                    <div>
                        <span class="metric-label">Outbreak responses per year</span>
                        <span class="metric-value" id="epi-outbreaks">-</span>
                    </div>
                </div>
                <div class="metric-single">
                    <span class="metric-label">Indicative benefit per cohort</span>
                    <span class="metric-value" id="epi-benefit">-</span>
                </div>
                <div class="chart-block">
                    <canvas id="chart-epi"></canvas>
                </div>
            </div>
        </div>
    </section>

    <!-- COSTING TAB -->
    <section id="tab-costing" class="tab-panel">
        <div class="grid-two-stretch">
            <div class="card">
                <h2>Cost templates and sources</h2>
                <div class="form-grid">
                    <div class="form-group">
                        <label for="cost-source">Cost template source</label>
                        <select id="cost-source">
                            <!-- Filled by script -->
                        </select>
                    </div>
                </div>
                <p>
                    Cost templates are based on detailed submissions from WHO, NIE and NCDC. For Frontline training,
                    WHO supplies a template based on six cohorts. For Intermediate training, templates are available
                    from WHO, NIE and NCDC. For Advanced training, templates are available from NIE and NCDC.
                </p>
                <p>
                    Templates are used as alternative settings rather than being combined. Policy makers can
                    switch between templates to see how cost structure affects total economic cost, while keeping
                    the programme design constant.
                </p>
                <p class="note">
                    For templates that include opportunity cost of trainee time, STEPS can add this to programme
                    costs when the opportunity cost option is switched on.
                </p>
            </div>

            <div class="card card-secondary">
                <h2>Cost components for this configuration</h2>
                <div id="cost-breakdown-summary" class="cost-summary">
                    <!-- Filled by script -->
                </div>
                <div class="cost-components-list" id="cost-components-list">
                    <!-- Detailed rows inserted by script -->
                </div>
            </div>
        </div>
    </section>

    <!-- SCENARIOS TAB -->
    <section id="tab-scenarios" class="tab-panel">
        <div class="card">
            <h2>Saved scenarios for comparison</h2>
            <p>
                Use this table to compare FETP options and support the business case for the World Bank and other
                partners. Saved scenarios are also used for downloads.
            </p>
            <div class="button-row">
                <button id="export-excel" class="btn-secondary">Download scenarios to Excel</button>
                <button id="export-pdf" class="btn-secondary">Download policy brief PDF</button>
            </div>
            <div class="table-wrapper">
                <table id="scenario-table">
                    <thead>
                    <tr>
                        <th>Name</th>
                        <th>Programme tier</th>
                        <th>Mentorship</th>
                        <th>Response time</th>
                        <th>Cohorts</th>
                        <th>Trainees per cohort</th>
                        <th>Cost per trainee per month</th>
                        <th>Preference model</th>
                        <th>Endorsement</th>
                        <th>BCR</th>
                        <th>Net benefit</th>
                    </tr>
                    </thead>
                    <tbody>
                    <!-- Rows added by script -->
                    </tbody>
                </table>
            </div>
        </div>
    </section>

    <!-- ABOUT TAB -->
    <section id="tab-about" class="tab-panel">
        <div class="card">
            <h2>About STEPS</h2>
            <p>
                The University of Newcastle is developing a business case for strengthening and scaling FETP
                programmes in India, with particular emphasis on Advanced FETP. STEPS is one of the core tools
                in this work. It provides a structured way to test scale up options and to explain the cost and
                benefit implications to policy makers.
            </p>
            <p>
                The tool is designed to support the Government of India, WHO, the World Bank and other partners
                as they plan investments in epidemiology training. It helps answer questions such as:
            </p>
            <ul class="plain-list">
                <li>How do costs and benefits change when we move from Frontline to Intermediate or Advanced tiers?</li>
                <li>What happens to endorsement when mentorship intensity is increased?</li>
                <li>How many cohorts and trainees are needed to reach a given scale?</li>
            </ul>
            <p class="note">
                Prepared by <strong>Mesfin Genie, PhD</strong>, Newcastle Business School, The University of
                Newcastle, Australia. For questions or clarifications please contact
                <a href="mailto:mesfin.genie@newcastle.edu.au">mesfin.genie@newcastle.edu.au</a>.
            </p>
        </div>
    </section>

    <!-- TECHNICAL TAB -->
    <section id="tab-technical" class="tab-panel">
        <div class="card">
            <h2>Advanced settings for workshops</h2>
            <p>
                This panel allows technical users to adjust key multipliers for workshops without editing code.
                Changes affect calculations immediately in this browser session.
            </p>
            <form id="advanced-settings-form" class="form-grid">
                <div class="form-group form-group-wide">
                    <label for="adv-inr-per-usd">Exchange rate for display (INR per USD)</label>
                    <input type="number" id="adv-inr-per-usd" step="0.1" min="10" max="500">
                    <p class="hint">Used only for currency display. All calculations are in INR.</p>
                </div>

                <div class="form-group">
                    <label for="adv-frontline-grads">Frontline graduates per cohort (share of trainees)</label>
                    <input type="number" id="adv-frontline-grads" step="0.01" min="0" max="1">
                </div>
                <div class="form-group">
                    <label for="adv-frontline-outbreaks">Frontline outbreak responses per cohort per year</label>
                    <input type="number" id="adv-frontline-outbreaks" step="0.1" min="0">
                </div>
                <div class="form-group">
                    <label for="adv-frontline-vgrad">Value per Frontline graduate (INR)</label>
                    <input type="number" id="adv-frontline-vgrad" step="10000" min="0">
                </div>
                <div class="form-group">
                    <label for="adv-frontline-voutbreak">Value per Frontline outbreak response (INR)</label>
                    <input type="number" id="adv-frontline-voutbreak" step="100000" min="0">
                </div>

                <div class="form-group">
                    <label for="adv-intermediate-grads">Intermediate graduates per cohort (share of trainees)</label>
                    <input type="number" id="adv-intermediate-grads" step="0.01" min="0" max="1">
                </div>
                <div class="form-group">
                    <label for="adv-intermediate-outbreaks">Intermediate outbreak responses per cohort per year</label>
                    <input type="number" id="adv-intermediate-outbreaks" step="0.1" min="0">
                </div>
                <div class="form-group">
                    <label for="adv-intermediate-vgrad">Value per Intermediate graduate (INR)</label>
                    <input type="number" id="adv-intermediate-vgrad" step="10000" min="0">
                </div>
                <div class="form-group">
                    <label for="adv-intermediate-voutbreak">Value per Intermediate outbreak response (INR)</label>
                    <input type="number" id="adv-intermediate-voutbreak" step="100000" min="0">
                </div>

                <div class="form-group">
                    <label for="adv-advanced-grads">Advanced graduates per cohort (share of trainees)</label>
                    <input type="number" id="adv-advanced-grads" step="0.01" min="0" max="1">
                </div>
                <div class="form-group">
                    <label for="adv-advanced-outbreaks">Advanced outbreak responses per cohort per year</label>
                    <input type="number" id="adv-advanced-outbreaks" step="0.1" min="0">
                </div>
                <div class="form-group">
                    <label for="adv-advanced-vgrad">Value per Advanced graduate (INR)</label>
                    <input type="number" id="adv-advanced-vgrad" step="10000" min="0">
                </div>
                <div class="form-group">
                    <label for="adv-advanced-voutbreak">Value per Advanced outbreak response (INR)</label>
                    <input type="number" id="adv-advanced-voutbreak" step="100000" min="0">
                </div>

                <div class="form-group form-group-wide">
                    <div class="button-row">
                        <button type="button" id="advanced-apply" class="btn-primary">Apply advanced settings</button>
                        <button type="button" id="advanced-reset" class="btn-ghost">Reset to defaults</button>
                    </div>
                </div>
            </form>
            <p class="note">
                Country teams can also supply an <code>epi_config.json</code> file with multipliers that STEPS
                will load automatically. The form above then reflects those values.
            </p>
        </div>

        <div class="card">
            <h2>Technical appendix</h2>
            <p>
                The technical appendix explains how STEPS uses discrete choice experiment estimates, cost
                templates and epidemiological multipliers. It includes numerical examples based on the final
                mixed logit and latent class models and the willingness to pay results.
            </p>
            <p>
                Open the full appendix in a separate window for easier reading or printing.
            </p>
            <button id="open-technical-window" class="btn-secondary">Open full technical appendix</button>
            <div id="technical-preview" class="technical-preview">
                <!-- Short preview inserted by script -->
            </div>
        </div>
    </section>
</main>

<!-- SNAPSHOT MODAL -->
<div id="results-modal" class="modal hidden">
    <div class="modal-content">
        <button class="modal-close" id="close-modal" aria-label="Close snapshot">&times;</button>
        <h2>Scenario summary</h2>
        <div id="modal-body">
            <!-- Filled by script -->
        </div>
    </div>
</div>

<!-- TOAST -->
<div id="toast" class="toast hidden"></div>

<!-- Hidden template for full technical appendix HTML -->
<script type="text/plain" id="technical-appendix-template">
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>STEPS Technical Appendix</title>
    <style>
        body {
            font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
            margin: 24px;
            line-height: 1.6;
            color: #0f172a;
        }
        h1, h2, h3 {
            color: #0b1120;
        }
        h1 { font-size: 1.8rem; margin-bottom: 0.6rem; }
        h2 { font-size: 1.4rem; margin-top: 1.8rem; }
        h3 { font-size: 1.15rem; margin-top: 1.2rem; }
        code {
            font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
            background: #e5e7eb;
            padding: 0.1rem 0.3rem;
            border-radius: 4px;
        }
        .equation {
            font-family: "Times New Roman", serif;
            background: #f9fafb;
            padding: 0.5rem 0.75rem;
            border-left: 3px solid #0ea5e9;
            margin: 0.75rem 0;
        }
        ul {
            padding-left: 1.4rem;
        }
        .ref-list {
            font-size: 0.9rem;
        }
    </style>
</head>
<body>
<h1>STEPS Technical Appendix</h1>
<p>
    This appendix explains how STEPS uses discrete choice experiment (DCE) estimates, costing information
    and simple epidemiological multipliers to support decisions on scaling Field Epidemiology Training
    Programs (FETPs) in India. It is written for technical readers who need transparency on the underlying
    calculations.
</p>

<h2>1. Discrete choice experiment and model specification</h2>
<p>
    The DCE presented three options in each task: Training A, Training B and an opt out. Each training option
    was defined by programme type (Frontline, Intermediate, Advanced), trainee career incentives (certificate,
    university qualification, government career pathway), mentorship intensity (low, medium, high), mode of
    delivery (blended, fully in person, fully online), response capacity (within 30, 15 or 7 days), and cost
    per trainee per month. Training B and the reference attribute levels form the baseline.
</p>
<p>
    The systematic part of utility for individual <em>n</em>, alternative <em>j</em> and task <em>t</em> is:
</p>
<div class="equation">
    U<sub>njt</sub> =
    α<sub>A,n</sub> ASC<sub>A,jt</sub> +
    α<sub>O,n</sub> ASC<sub>OptOut,jt</sub> +
    β<sub>1,n</sub> Intermediate<sub>jt</sub> +
    β<sub>2,n</sub> Advanced<sub>jt</sub> +
    β<sub>3,n</sub> UniQual<sub>jt</sub> +
    β<sub>4,n</sub> GovCareer<sub>jt</sub> +
    β<sub>5,n</sub> MentorMedium<sub>jt</sub> +
    β<sub>6,n</sub> MentorHigh<sub>jt</sub> +
    β<sub>7,n</sub> InPerson<sub>jt</sub> +
    β<sub>8,n</sub> Online<sub>jt</sub> +
    β<sub>9,n</sub> Resp15<sub>jt</sub> +
    β<sub>10,n</sub> Resp7<sub>jt</sub> +
    β<sub>11,n</sub> Cost<sub>njt</sub>.
</div>
<p>
    ASC<sub>A,jt</sub> is one for Training A and zero otherwise. ASC<sub>OptOut,jt</sub> is one for the opt out.
    Cost is measured in thousands of rupees per trainee per month. Training B and the reference levels
    (Frontline, certificate, low mentorship, blended, response within 30 days) are omitted from the equation.
</p>

<h2>2. Mixed logit model and final estimates</h2>
<p>
    To allow for preference heterogeneity, a mixed logit model was estimated. Non cost coefficients follow
    independent normal distributions. The cost coefficient follows a log normal distribution:
</p>
<div class="equation">
    β<sub>11,n</sub> = -exp( μ<sub>cost</sub> + σ<sub>cost</sub> η<sub>n</sub> ), with η<sub>n</sub> ~ N(0,1),
</div>
<p>
    which ensures that higher cost always reduces utility.
</p>
<p>
    The main mixed logit results used in STEPS are:
</p>
<ul>
    <li>Alternative specific constant for Training A (ASC A): 0.168 (fixed in the random part).</li>
    <li>Alternative specific constant for opt out: -0.601.</li>
    <li>Programme type: Intermediate 0.220, Advanced 0.487.</li>
    <li>Career incentives: university qualification 0.017, government career pathway -0.122.</li>
    <li>Mentorship: medium 0.453, high 0.640.</li>
    <li>Delivery: fully in person -0.232, fully online -1.073.</li>
    <li>Response capacity: within 15 days 0.546, within 7 days 0.610.</li>
    <li>Back transformed mean cost coefficient: -0.005 per thousand rupees per trainee per month.</li>
</ul>
<p>
    In STEPS these values are stored in the <code>PREFERENCE_MODELS.mxl</code> object. Only the opt out constant
    is used for endorsement predictions, since the left right constant is a layout effect rather than a policy
    feature.
</p>

<h2>3. Latent class model and supportive group</h2>
<p>
    A two class latent class model distinguishes between training resisters (Class 1) and training supporters
    (Class 2). STEPS uses the Class 2 parameters to represent a more supportive stakeholder group.
</p>
<p>
    For Class 2, key estimates are:
</p>
<ul>
    <li>ASC for Training A: 0.098.</li>
    <li>ASC for opt out: -2.543.</li>
    <li>Advanced programme: 0.422.</li>
    <li>Mentorship medium and high: 0.342 and 0.486.</li>
    <li>Response capacity within 15 and 7 days: 0.317 and 0.504.</li>
    <li>Cost coefficient: -0.001 per thousand rupees per trainee per month.</li>
</ul>
<p>
    In STEPS these values are stored in <code>PREFERENCE_MODELS.lc2</code>. This option can be selected under
    Preference model in the configuration panel.
</p>

<h2>4. Willingness to pay examples</h2>
<p>
    For a DCE with a linear cost term the willingness to pay (WTP) for moving from the reference level to
    level <em>k</em> is:
</p>
<div class="equation">
    WTP<sub>k</sub> = - β<sub>k</sub> / β<sub>cost</sub>.
</div>
<p>
    For the mixed logit model, with mean cost coefficient -0.005, the main WTP estimates are:
</p>
<ul>
    <li>Intermediate programme: about 47,060 INR per trainee per month.</li>
    <li>Advanced programme: about 103,990 INR per trainee per month.</li>
    <li>Medium mentorship: about 96,870 INR per trainee per month.</li>
    <li>High mentorship: about 136,790 INR per trainee per month.</li>
    <li>Fully in person delivery: about -49,560 INR per trainee per month.</li>
    <li>Fully online delivery: about -229,330 INR per trainee per month.</li>
    <li>Response within 15 days: about 116,700 INR per trainee per month.</li>
    <li>Response within 7 days: about 130,460 INR per trainee per month.</li>
</ul>
<p>
    These values are stored in <code>WTP_TABLE.mxl</code> and are used to construct an indicative monetary
    benefit per trainee per month for a configuration.
</p>
<p>
    For Class 2 of the latent class model, STEPS calculates implied WTP values using the same formula and
    the Class 2 cost coefficient of -0.001. For example, the WTP for Advanced training for the supportive
    group is roughly 422,000 INR per trainee per month.
</p>

<h2>5. From model outputs to endorsement</h2>
<p>
    To move from model coefficients to a simple endorsement probability, STEPS aggregates the relevant
    parameters into a single index. For a given configuration, the difference in systematic utility between
    "some FETP" and "no FETP" is:
</p>
<div class="equation">
    ΔV = -α<sub>O</sub> + Σ β<sub>k</sub> x<sub>k</sub> + β<sub>cost</sub> · (C / 1000),
</div>
<p>
    where α<sub>O</sub> is the opt out constant, x<sub>k</sub> are the chosen attribute levels and C is the cost
    per trainee per month in rupees. The endorsement probability is given by the logistic function:
</p>
<div class="equation">
    P(endorse FETP) = exp(ΔV) / (1 + exp(ΔV)).
</div>
<p>
    STEPS implements this for the mixed logit mean parameters and, when selected, for the Class 2 parameters.
</p>

<h2>6. Cost templates and economic cost per cohort</h2>
<p>
    For each cost template, STEPS takes the component totals and normalises them to shares of total cost.
    Opportunity cost of trainee time is identified where present. For a given configuration, the programme
    cost per cohort is:
</p>
<div class="equation">
    C<sub>prog</sub> = CostPerTraineePerMonth × TraineesPerCohort × DurationMonths.
</div>
<p>
    This is allocated across cost components using the template shares, excluding opportunity cost. If the
    opportunity cost toggle is on and the template contains an opportunity cost estimate, STEPS adds a
    separate opportunity cost term to yield a total economic cost per cohort.
</p>

<h2>7. Epidemiological multipliers</h2>
<p>
    Epidemiological multipliers translate training outputs into simple public health metrics. For each
    tier STEPS uses four multipliers:
</p>
<ul>
    <li>Graduates per cohort as a share of trainees.</li>
    <li>Outbreak responses per cohort per year.</li>
    <li>Value per additional graduate (in INR).</li>
    <li>Value per outbreak response supported (in INR).</li>
</ul>
<p>
    For example, with default settings an Advanced cohort with 20 trainees and an endorsement rate of 60 percent
    yields about 11 or 12 graduates. If each Advanced graduate is assigned a monetary value and each cohort
    is assumed to support several outbreak investigations per year, STEPS converts these into an indicative
    benefit per cohort. The benefit cost ratio and net benefit shown in the tool use these values.
</p>
<p>
    The multipliers can be updated either by editing <code>epi_config.json</code> or by adjusting the numbers
    in the advanced settings panel in the Technical tab.
</p>

<h2>8. Limitations and recommended use</h2>
<p>
    STEPS is a decision aid, not a full transmission model. It focuses on preferences, costs and simple
    benefit indicators that can be understood in policy discussions. The epidemiological multipliers and
    monetary valuations are stylised. For major investment decisions they should be cross checked against
    detailed burden of disease or health security models.
</p>

<h2>9. Authorship and contact</h2>
<p>
    STEPS and this technical appendix were prepared for the business case for FETP scale up in India by
    Mesfin Genie, Newcastle Business School, The University of Newcastle, Australia. For technical questions
    or requests to adapt the tool for other countries, please contact
    <a href="mailto:mesfin.genie@newcastle.edu.au">mesfin.genie@newcastle.edu.au</a>.
</p>
</body>
</html>
</script>

<script src="script.js"></script>
</body>
</html>
