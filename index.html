<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>STEPS FETP Scale Up Decision Aid</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="styles.css">

    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
    <!-- jsPDF -->
    <script src="https://cdn.jsdelivr.net/npm/jspdf@2.5.1/dist/jspdf.umd.min.js"></script>
    <!-- SheetJS for Excel export -->
    <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
</head>
<body>
<header class="app-header">
    <div class="app-header-left">
        <div class="app-logo-circle">S</div>
        <div>
            <h1 class="app-title">STEPS</h1>
            <p class="app-subtitle">Scalable Training Estimation and Planning System for FETP India</p>
        </div>
    </div>
    <div class="app-header-right">
        <span class="badge-primary">Policy decision aid</span>
        <span class="badge-outline">Version 1.0</span>
    </div>
</header>

<main class="app-shell">
    <nav class="tab-bar">
        <button class="tab-link active" data-tab="intro">Introduction</button>
        <button class="tab-link" data-tab="attributes">Attributes</button>
        <button class="tab-link" data-tab="config">Configuration</button>
        <button class="tab-link" data-tab="results">Results</button>
        <button class="tab-link" data-tab="costing">Costing details</button>
        <button class="tab-link" data-tab="natsim">National simulation</button>
        <button class="tab-link" data-tab="scenarios">Saved scenarios</button>
        <button class="tab-link" data-tab="about">About STEPS</button>
        <button class="tab-link" data-tab="technical">Advanced and methods</button>
    </nav>

    <!-- INTRO TAB -->
    <section id="tab-intro" class="tab-panel active">
        <div class="grid-two">
            <div class="card">
                <h2>What STEPS does</h2>
                <p>
                    STEPS helps policy makers and partners explore different options for scaling Field Epidemiology
                    Training Programs in India. It links three main inputs:
                </p>
                <ul class="plain-list">
                    <li>Preferences from a discrete choice experiment with stakeholders.</li>
                    <li>Costing templates from WHO, NIE and NCDC for Frontline, Intermediate and Advanced programmes.</li>
                    <li>Simple epidemiological multipliers that translate training scale up into public health benefits.</li>
                </ul>
                <p>
                    Users can set a programme configuration, see endorsement rates, costs and benefit cost ratios,
                    and compare saved scenarios side by side for business case discussions.
                </p>
            </div>
            <div class="card">
                <h2>How to use the tool</h2>
                <ol class="plain-list numbered">
                    <li>Go to the <strong>Configuration</strong> tab and choose programme tier, mentorship,
                        response time, delivery mode, number of cohorts, cohort size and cost per trainee per month.
                    </li>
                    <li>Keep the cost slider within the range used in the experiment (75,000 to 400,000 rupees per trainee per month).</li>
                    <li>Select the preference model: mixed logit or the supportive latent class group.</li>
                    <li>Click <strong>Apply configuration</strong> and <strong>View results</strong> to see a modal
                        summary with headline recommendations.
                    </li>
                    <li>Save promising scenarios in the <strong>Saved scenarios</strong> tab and download them as
                        Excel or a policy brief PDF for reporting.</li>
                    <li>For workshops or sensitivity checks, use the <strong>Advanced and methods</strong> tab to adjust
                        the display exchange rate and simple epidemiological multipliers. All calculations still remain
                        in INR, but this allows scenario testing without changing the code.</li>
                </ol>
                <p class="note">
                    STEPS is designed for laptops, desktops, tablets and mobiles. It can be used live in workshops
                    with central and state level partners.
                </p>
            </div>
        </div>
    </section>

    <!-- ATTRIBUTES TAB -->
    <section id="tab-attributes" class="tab-panel">
        <div class="card">
            <h2>Attributes and levels in the FETP DCE</h2>
            <p>
                The discrete choice experiment asked respondents to choose between two FETP training options
                and an opt out. Each training option was defined by the attributes below.
            </p>
            <div class="attributes-grid">
                <div class="attr-card">
                    <h3>Programme tier</h3>
                    <p>
                        Depth and duration of training.
                    </p>
                    <ul class="plain-list">
                        <li><strong>Frontline</strong>: about three months, basic surveillance skills.</li>
                        <li><strong>Intermediate</strong>: around twelve months, usually while staff stay in post.</li>
                        <li><strong>Advanced</strong>: two year fellowship for national and state level staff.</li>
                    </ul>
                </div>
                <div class="attr-card">
                    <h3>Career incentives</h3>
                    <p>
                        Formal recognition and career consequences of completing FETP.
                    </p>
                    <ul class="plain-list">
                        <li><strong>Government and partner certificate</strong> (reference).</li>
                        <li><strong>University qualification</strong> such as a diploma or degree.</li>
                        <li><strong>Government career pathway</strong> with clearer promotion prospects.</li>
                    </ul>
                </div>
                <div class="attr-card">
                    <h3>Mentorship intensity</h3>
                    <p>
                        Amount of support trainees receive from experienced epidemiologists.
                    </p>
                    <ul class="plain-list">
                        <li><strong>Low mentorship</strong> (reference).</li>
                        <li><strong>Medium mentorship</strong> with regular support.</li>
                        <li><strong>High mentorship</strong> with close supervision.</li>
                    </ul>
                </div>
                <div class="attr-card">
                    <h3>Mode of delivery</h3>
                    <p>
                        How training and supervision are delivered.
                    </p>
                    <ul class="plain-list">
                        <li><strong>Blended</strong> (reference): mix of face to face and online.</li>
                        <li><strong>Fully in person</strong>.</li>
                        <li><strong>Fully online</strong>.</li>
                    </ul>
                </div>
                <div class="attr-card">
                    <h3>Response capacity</h3>
                    <p>
                        Speed of response to public health events.
                    </p>
                    <ul class="plain-list">
                        <li><strong>Within 30 days</strong> (reference).</li>
                        <li><strong>Within 15 days</strong>.</li>
                        <li><strong>Within 7 days</strong>.</li>
                    </ul>
                </div>
                <div class="attr-card">
                    <h3>Cost per trainee per month</h3>
                    <p>
                        Total programme cost per trainee per month. In the experiment this varied from
                        75,000 to 400,000 rupees per trainee per month. STEPS keeps the slider inside this
                        range so that outputs remain within the values used in the models.
                    </p>
                </div>
            </div>
            <p class="note">
                Training B and reference attribute levels form the baseline. The alternative specific constant
                for Training A captures a left right layout effect. The opt out constant captures the general
                tendency to choose neither training option. STEPS uses the opt out constant when predicting
                overall endorsement of any FETP option versus no FETP.
            </p>
        </div>
    </section>

    <!-- CONFIG TAB -->
    <section id="tab-config" class="tab-panel">
        <div class="grid-two-stretch">
            <div class="card">
                <h2>Configure an FETP scale up option</h2>
                <div class="form-grid">
                    <div class="form-group">
                        <label for="program-tier">
                            Programme tier
                            <span class="info-icon" title="Decides whether the training is Frontline, Intermediate or Advanced. This controls the duration, level of skills and intensity of the programme.">i</span>
                        </label>
                        <select id="program-tier">
                            <option value="frontline">Frontline (3 months)</option>
                            <option value="intermediate">Intermediate (12 months)</option>
                            <option value="advanced">Advanced (24 months)</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="career-track">
                            Career incentive
                            <span class="info-icon" title="Formal recognition and career benefits that follow completion of FETP, such as certificates, university qualifications or clearer promotion pathways.">i</span>
                        </label>
                        <select id="career-track">
                            <option value="certificate">Government and partner certificate</option>
                            <option value="uniqual">University qualification</option>
                            <option value="career_path">Government career pathway</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="mentorship">
                            Mentorship intensity
                            <span class="info-icon" title="How much support trainees receive from experienced epidemiologists during the programme, from low touch to highly intensive mentorship.">i</span>
                        </label>
                        <select id="mentorship">
                            <option value="low">Low mentorship</option>
                            <option value="medium">Medium mentorship</option>
                            <option value="high">High mentorship</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="delivery">
                            Mode of delivery
                            <span class="info-icon" title="Balance between face to face and online activities. This affects feasibility, travel requirements and interaction with mentors.">i</span>
                        </label>
                        <select id="delivery">
                            <option value="blended">Blended</option>
                            <option value="inperson">Fully in person</option>
                            <option value="online">Fully online</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="response">
                            Expected response time for events
                            <span class="info-icon" title="How quickly trained staff are expected to respond to outbreaks and public health events, from within 30 days down to within 7 days.">i</span>
                        </label>
                        <select id="response">
                            <option value="30">Within 30 days</option>
                            <option value="15">Within 15 days</option>
                            <option value="7">Within 7 days</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="cost-slider">
                            Cost per trainee per month (<span id="currency-label">INR</span>)
                            <span class="info-icon" title="Total monthly cost per trainee for running the programme. The slider is kept inside the range used in the discrete choice experiment (75,000 to 400,000 INR).">i</span>
                        </label>
                        <input type="range" id="cost-slider" min="75000" max="400000" step="5000" value="250000">
                        <div class="slider-value">
                            <span id="cost-display">INR 250,000</span>
                            <span class="slider-hint">
                                Within the range used in the discrete choice experiment (75,000 to 400,000 rupees).
                            </span>
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="trainees">
                            Trainees per cohort
                            <span class="info-icon" title="Number of trainees in one cohort. This controls cohort size and, together with programme length and cost, drives total programme cost.">i</span>
                        </label>
                        <input type="number" id="trainees" min="5" max="60" value="20">
                        <p class="hint">
                            Use this to test smaller or larger cohort sizes. For example, moving from 20 to 30 trainees
                            per cohort increases both costs and epidemiological benefits.
                        </p>
                    </div>

                    <div class="form-group">
                        <label for="cohorts">
                            Number of cohorts
                            <span class="info-icon" title="Number of cohorts you plan to run nationally under this configuration. This scales up costs and benefits from one cohort to a national programme.">i</span>
                        </label>
                        <input type="number" id="cohorts" min="1" max="100" value="10">
                        <p class="hint">
                            Increase this to explore national scale up (for example 30 or 50 cohorts). The National simulation tab
                            shows how total costs and benefits change as you adjust this number.
                        </p>
                    </div>

                    <div class="form-group">
                        <label>Preference model</label>
                        <div class="pill-toggle-group">
                            <button type="button" class="pill-toggle active" data-model="mxl">
                                Average mixed logit
                            </button>
                            <button type="button" class="pill-toggle" data-model="lc2">
                                Supportive group (latent class)
                            </button>
                        </div>
                        <p class="hint">
                            The supportive group uses the Class 2 parameters from the latent class model. Class 1 represents
                            training resisters who are largely cost insensitive, with imprecisely estimated willingness to pay,
                            and is not recommended for policy targeting.
                        </p>
                    </div>

                    <div class="form-group">
                        <label>Currency display</label>
                        <div class="pill-toggle-group">
                            <button type="button" class="pill-toggle active" data-currency="INR">
                                INR (calculations)
                            </button>
                            <button type="button" class="pill-toggle" data-currency="USD">
                                Approximate USD
                            </button>
                        </div>
                        <p class="hint">
                            All calculations are in INR. USD values use a simple exchange rate for display only.
                        </p>
                    </div>

                    <div class="form-group">
                        <label>
                            Include opportunity cost of trainee time
                            <span class="info-icon" title="Adds the value of trainee time to costs when templates include opportunity cost entries. Switching this off shows only direct financial costs.">i</span>
                        </label>
                        <button type="button" id="opp-toggle" class="switch-pill on">
                            <span class="switch-knob"></span>
                            <span class="switch-label">Opportunity cost included</span>
                        </button>
                        <p class="hint">
                            Where the cost template has opportunity cost, this adds it to economic costs.
                        </p>
                    </div>

                    <div class="form-group form-group-wide">
                        <label for="scenario-name">Scenario name</label>
                        <input type="text" id="scenario-name" placeholder="For example: Advanced high mentorship 20 cohorts">
                    </div>

                    <div class="form-group form-group-wide">
                        <label for="scenario-notes">Scenario notes</label>
                        <textarea id="scenario-notes" rows="3"
                                  placeholder="Optional notes for World Bank reporting and meetings with ministries."></textarea>
                    </div>
                </div>

                <div class="button-row">
                    <button id="update-results" class="btn-primary">Apply configuration</button>
                    <button id="open-snapshot" class="btn-secondary">View results</button>
                    <button id="save-scenario" class="btn-ghost">Save scenario</button>
                </div>
            </div>

            <div class="card card-secondary">
                <h2>Current configuration at a glance</h2>
                <div id="config-summary" class="config-summary"></div>
                <hr class="divider">
                <div class="config-endorsement-row">
                    <span class="metric-label">Endorsement (current model)</span>
                    <span class="metric-value config-endorsement-value" id="config-endorsement-value">Apply configuration</span>
                </div>
                <h3>Headline recommendation</h3>
                <p id="headline-recommendation" class="headline-text">
                    Apply a configuration to see a concise recommendation.
                </p>
            </div>
        </div>
    </section>

    <!-- RESULTS TAB -->
    <section id="tab-results" class="tab-panel">
        <div class="grid-three">
            <div class="card">
                <h2>Endorsement and opt out</h2>
                <p class="hint">
                    These percentages are obtained by plugging the chosen configuration into the mixed logit or latent class
                    model and comparing the utility of any FETP option with the utility of opting out. They summarise how
                    attractive the configuration is to stakeholders in the DCE.
                </p>
                <div class="metric-pair">
                    <div>
                        <span class="metric-label">Endorse FETP option</span>
                        <span class="metric-value" id="endorsement-rate">-</span>
                    </div>
                    <div>
                        <span class="metric-label">Choose opt out</span>
                        <span class="metric-value" id="optout-rate">-</span>
                    </div>
                </div>
                <div class="chart-block">
                    <canvas id="chart-uptake"></canvas>
                </div>
            </div>

            <div class="card">
                <h2>Costs and benefits per cohort</h2>
                <p class="hint">
                    Total economic cost per cohort combines the cost slider, cohort size, programme duration and the selected
                    cost template, with opportunity cost added when the switch is on. Benefits per cohort are based on
                    willingness to pay for moving from the baseline design to the chosen configuration. Net benefit is the
                    difference between benefits and costs. The benefit cost ratio is benefits divided by costs.
                </p>
                <div class="metric-pair">
                    <div>
                        <span class="metric-label">Total economic cost</span>
                        <span class="metric-value" id="total-cost">-</span>
                    </div>
                    <div>
                        <span class="metric-label">Net benefit</span>
                        <span class="metric-value" id="net-benefit">-</span>
                    </div>
                </div>
                <div class="metric-single">
                    <span class="metric-label">Benefit cost ratio</span>
                    <span class="metric-value" id="bcr">-</span>
                </div>
                <div class="chart-block">
                    <canvas id="chart-bcr"></canvas>
                </div>
            </div>

            <div class="card">
                <h2>Epidemiological implications</h2>
                <p class="hint">
                    Graduates and outbreak responses are obtained by combining the endorsement level with simple multipliers
                    on cohort size and number of cohorts. Indicative benefit per cohort converts additional graduates and
                    outbreak responses into monetary terms using values that can be adjusted in the Advanced and methods tab
                    or the external epi_config file.
                </p>
                <div class="metric-pair">
                    <div>
                        <span class="metric-label">FETP graduates (all cohorts)</span>
                        <span class="metric-value" id="epi-graduates">-</span>
                    </div>
                    <div>
                        <span class="metric-label">Outbreak responses per year</span>
                        <span class="metric-value" id="epi-outbreaks">-</span>
                    </div>
                </div>
                <div class="metric-single">
                    <span class="metric-label">Indicative benefit per cohort</span>
                    <span class="metric-value" id="epi-benefit">-</span>
                </div>
                <div class="chart-block">
                    <canvas id="chart-epi"></canvas>
                </div>
            </div>
        </div>
    </section>

    <!-- COSTING TAB -->
    <section id="tab-costing" class="tab-panel">
        <div class="grid-two-stretch">
            <div class="card">
                <h2>Cost templates and sources</h2>
                <div class="form-grid">
                    <div class="form-group">
                        <label for="cost-source">
                            Cost template source
                            <span class="info-icon" title="Choose whether to use WHO, NIE or NCDC cost templates for the selected tier. This affects the structure of costs but not the preference model.">i</span>
                        </label>
                        <select id="cost-source"></select>
                    </div>
                </div>
                <p>
                    Cost templates are based on submissions from WHO, NIE and NCDC. For Frontline training,
                    WHO supplies a template for six cohorts. For Intermediate training, templates are available
                    from WHO, NIE and NCDC. For Advanced training, templates are available from NIE and NCDC.
                </p>
                <p>
                    Templates are used as alternative settings rather than being combined. Policy makers can
                    switch between templates to see how cost structure affects economic cost while holding
                    programme design constant.
                </p>
                <p class="note">
                    Templates that include the opportunity cost of trainee time feed into total economic cost
                    when the opportunity cost switch is on.
                </p>
            </div>

            <div class="card card-secondary">
                <h2>Cost components for this configuration</h2>
                <div id="cost-breakdown-summary" class="cost-summary"></div>
                <div class="cost-components-list" id="cost-components-list"></div>
            </div>
        </div>
    </section>

    <!-- NATIONAL SIMULATION TAB -->
    <section id="tab-natsim" class="tab-panel">
        <div class="card">
            <h2>National simulation and sensitivity</h2>
            <p>
                This view scales the current configuration to the national level using the number of cohorts you
                have selected. It is intended for quick business case discussions and high level sensitivity checks.
                To see how results change, adjust cost, cohort size, number of cohorts or the epidemiological
                multipliers in the Advanced and methods tab.
            </p>
            <div class="grid-two">
                <div>
                    <h3>National economic picture</h3>
                    <div class="metric-pair">
                        <div>
                            <span class="metric-label">Total economic cost (all cohorts)</span>
                            <span class="metric-value" id="nat-total-cost">-</span>
                        </div>
                        <div>
                            <span class="metric-label">Total benefit (all cohorts)</span>
                            <span class="metric-value" id="nat-total-benefit">-</span>
                        </div>
                    </div>
                    <div class="metric-pair">
                        <div>
                            <span class="metric-label">National net benefit</span>
                            <span class="metric-value" id="nat-net-benefit">-</span>
                        </div>
                        <div>
                            <span class="metric-label">National benefit cost ratio</span>
                            <span class="metric-value" id="nat-bcr">-</span>
                        </div>
                    </div>
                    <p class="hint">
                        These values multiply the per cohort costs and benefits by the number of cohorts. The ratios
                        stay the same, but the absolute costs and benefits grow with scale.
                    </p>
                </div>
                <div>
                    <h3>National epidemiological impact</h3>
                    <div class="metric-pair">
                        <div>
                            <span class="metric-label">Total FETP graduates</span>
                            <span class="metric-value" id="nat-graduates">-</span>
                        </div>
                        <div>
                            <span class="metric-label">Outbreak responses supported per year</span>
                            <span class="metric-value" id="nat-outbreaks">-</span>
                        </div>
                    </div>
                    <p class="hint">
                        Graduates and outbreak responses here are already national figures, combining endorsement,
                        cohort size, number of cohorts and the epidemiological multipliers. To explore sensitivity,
                        try increasing cohorts, testing different programme tiers or changing multipliers in
                        Advanced and methods.
                    </p>
                </div>
            </div>
        </div>
    </section>

    <!-- SCENARIOS TAB -->
    <section id="tab-scenarios" class="tab-panel">
        <div class="card">
            <h2>Saved scenarios for comparison</h2>
            <p>
                Use this table to compare FETP options and support the business case for the World Bank and
                other partners. Saved scenarios are also used for downloads.
            </p>
            <div class="button-row">
                <button id="export-excel" class="btn-secondary">Download scenarios to Excel</button>
                <button id="export-pdf" class="btn-secondary">Download policy brief PDF</button>
            </div>
            <div class="table-wrapper">
                <table id="scenario-table">
                    <thead>
                    <tr>
                        <th>Name</th>
                        <th>Programme tier</th>
                        <th>Mentorship</th>
                        <th>Response time</th>
                        <th>Cohorts</th>
                        <th>Trainees</th>
                        <th>Cost per trainee per month</th>
                        <th>Preference model</th>
                        <th>Endorsement</th>
                        <th>BCR</th>
                        <th>Net benefit</th>
                    </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </div>
        </div>
    </section>

    <!-- ABOUT TAB -->
    <section id="tab-about" class="tab-panel">
        <div class="card">
            <h2>About STEPS</h2>
            <p>
                The University of Newcastle is developing a business case for strengthening and scaling FETP
                programmes in India, with particular emphasis on Advanced FETP. STEPS is one of the tools in
                this work. It provides a structured way to test scale up options and explain cost and benefit
                implications in policy discussions.
            </p>
            <p>
                The tool is designed to support the Government of India, WHO, the World Bank and other partners
                as they plan investments in epidemiology training. It helps answer questions such as:
            </p>
            <ul class="plain-list">
                <li>How do costs and benefits change when moving from Frontline to Intermediate or Advanced tiers?</li>
                <li>What happens to endorsement when mentorship intensity is increased?</li>
                <li>How many cohorts and trainees are needed to reach target scale?</li>
            </ul>
            <p class="note">
                Prepared by <strong>Mesfin Genie, PhD</strong>, Newcastle Business School, The University of
                Newcastle, Australia. For questions or clarifications please contact
                <a href="mailto:mesfin.genie@newcastle.edu.au">mesfin.genie@newcastle.edu.au</a>.
            </p>
        </div>
    </section>

    <!-- TECHNICAL / ADVANCED TAB -->
    <section id="tab-technical" class="tab-panel">
        <div class="card">
            <h2>Advanced settings for workshops</h2>
            <p>
                This panel allows technical users to adjust key multipliers for workshops without editing code.
                Changes affect calculations immediately in this browser session and are reflected in the Results
                and National simulation tabs.
            </p>
            <p class="note">
                Use these settings when you want to align STEPS assumptions with updated national estimates or
                World Bank discussions. For example, you can change the indicative value per graduate or per outbreak
                response, or match the INR to USD display rate to current exchange rates.
            </p>
            <form id="advanced-settings-form" class="form-grid">
                <div class="form-group form-group-wide">
                    <label for="adv-inr-per-usd">
                        Exchange rate for display (INR per USD)
                        <span class="info-icon" title="Used only to convert INR values into USD for display. Changing this does not affect calculations, only the USD labels shown in the interface.">i</span>
                    </label>
                    <input type="number" id="adv-inr-per-usd" step="0.1" min="10" max="500">
                    <p class="hint">Used only for currency display. All calculations are in INR.</p>
                </div>

                <div class="form-group">
                    <label for="adv-frontline-grads">
                        Frontline graduates per cohort (share of trainees)
                        <span class="info-icon" title="Share of trainees that successfully graduate from a Frontline cohort. For example 0.9 means 90 percent of trainees graduate.">i</span>
                    </label>
                    <input type="number" id="adv-frontline-grads" step="0.01" min="0" max="1">
                </div>
                <div class="form-group">
                    <label for="adv-frontline-outbreaks">
                        Frontline outbreak responses per cohort per year
                        <span class="info-icon" title="Approximate number of outbreak responses that a typical Frontline cohort supports each year once graduates are deployed.">i</span>
                    </label>
                    <input type="number" id="adv-frontline-outbreaks" step="0.1" min="0">
                </div>
                <div class="form-group">
                    <label for="adv-frontline-vgrad">
                        Value per Frontline graduate (INR)
                        <span class="info-icon" title="Indicative monetary value placed on one additional trained Frontline graduate, capturing better surveillance and response capacity.">i</span>
                    </label>
                    <input type="number" id="adv-frontline-vgrad" step="10000" min="0">
                </div>
                <div class="form-group">
                    <label for="adv-frontline-voutbreak">
                        Value per Frontline outbreak response (INR)
                        <span class="info-icon" title="Indicative value per outbreak response supported by graduates, for example avoided cases or deaths monetised for business case purposes.">i</span>
                    </label>
                    <input type="number" id="adv-frontline-voutbreak" step="100000" min="0">
                </div>

                <div class="form-group">
                    <label for="adv-intermediate-grads">
                        Intermediate graduates per cohort (share of trainees)
                        <span class="info-icon" title="Share of trainees that successfully graduate from an Intermediate cohort.">i</span>
                    </label>
                    <input type="number" id="adv-intermediate-grads" step="0.01" min="0" max="1">
                </div>
                <div class="form-group">
                    <label for="adv-intermediate-outbreaks">
                        Intermediate outbreak responses per cohort per year
                        <span class="info-icon" title="Approximate number of outbreak responses that an Intermediate cohort supports each year.">i</span>
                    </label>
                    <input type="number" id="adv-intermediate-outbreaks" step="0.1" min="0">
                </div>
                <div class="form-group">
                    <label for="adv-intermediate-vgrad">
                        Value per Intermediate graduate (INR)
                        <span class="info-icon" title="Indicative value per additional Intermediate graduate.">i</span>
                    </label>
                    <input type="number" id="adv-intermediate-vgrad" step="10000" min="0">
                </div>
                <div class="form-group">
                    <label for="adv-intermediate-voutbreak">
                        Value per Intermediate outbreak response (INR)
                        <span class="info-icon" title="Indicative value per outbreak response supported by Intermediate graduates.">i</span>
                    </label>
                    <input type="number" id="adv-intermediate-voutbreak" step="100000" min="0">
                </div>

                <div class="form-group">
                    <label for="adv-advanced-grads">
                        Advanced graduates per cohort (share of trainees)
                        <span class="info-icon" title="Share of trainees that successfully graduate from an Advanced cohort. Often assumed to be high given the selectiveness of Advanced programmes.">i</span>
                    </label>
                    <input type="number" id="adv-advanced-grads" step="0.01" min="0" max="1">
                </div>
                <div class="form-group">
                    <label for="adv-advanced-outbreaks">
                        Advanced outbreak responses per cohort per year
                        <span class="info-icon" title="Approximate number of outbreak responses that an Advanced cohort supports per year, reflecting the more strategic roles of graduates.">i</span>
                    </label>
                    <input type="number" id="adv-advanced-outbreaks" step="0.1" min="0">
                </div>
                <div class="form-group">
                    <label for="adv-advanced-vgrad">
                        Value per Advanced graduate (INR)
                        <span class="info-icon" title="Indicative value per Advanced graduate, capturing leadership, analytic capacity and system wide impacts.">i</span>
                    </label>
                    <input type="number" id="adv-advanced-vgrad" step="10000" min="0">
                </div>
                <div class="form-group">
                    <label for="adv-advanced-voutbreak">
                        Value per Advanced outbreak response (INR)
                        <span class="info-icon" title="Indicative value per outbreak response supported by Advanced graduates, often higher due to more complex events.">i</span>
                    </label>
                    <input type="number" id="adv-advanced-voutbreak" step="100000" min="0">
                </div>

                <div class="form-group form-group-wide">
                    <div class="button-row">
                        <button type="button" id="advanced-apply" class="btn-primary">Apply advanced settings</button>
                        <button type="button" id="advanced-reset" class="btn-ghost">Reset to defaults</button>
                    </div>
                </div>
            </form>
            <p class="note">
                Country teams can also supply an <code>epi_config.json</code> file with multipliers that STEPS
                will load automatically.
            </p>
        </div>

        <div class="card">
            <h2>Technical appendix</h2>
            <p>
                The technical appendix explains how STEPS uses discrete choice experiment estimates, cost
                templates and epidemiological multipliers. It includes numerical examples based on the final
                mixed logit and latent class models and the willingness to pay results.
            </p>
            <p>
                Open the full appendix in a separate window for easier reading or printing.
            </p>
            <button id="open-technical-window" class="btn-secondary">Open full technical appendix</button>
            <div id="technical-preview" class="technical-preview"></div>
        </div>
    </section>
</main>

<!-- SNAPSHOT MODAL -->
<div id="results-modal" class="modal hidden">
    <div class="modal-content">
        <button class="modal-close" id="close-modal" aria-label="Close snapshot">&times;</button>
        <h2>Scenario summary</h2>
        <div id="modal-body"></div>
    </div>
</div>

<!-- TOAST -->
<div id="toast" class="toast hidden"></div>

<!-- Hidden template for full technical appendix HTML -->
<script type="text/plain" id="technical-appendix-template">
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>STEPS Technical Appendix</title>
    <style>
        body {
            font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
            margin: 24px;
            line-height: 1.6;
            color: #0f172a;
        }
        h1, h2, h3 {
            color: #0b1120;
        }
        h1 { font-size: 1.8rem; margin-bottom: 0.6rem; }
        h2 { font-size: 1.4rem; margin-top: 1.8rem; }
        h3 { font-size: 1.15rem; margin-top: 1.2rem; }
        code {
            font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
            background: #e5e7eb;
            padding: 0.1rem 0.3rem;
            border-radius: 4px;
        }
        .equation {
            font-family: "Times New Roman", serif;
            background: #f9fafb;
            padding: 0.5rem 0.75rem;
            border-left: 3px solid #0ea5e9;
            margin: 0.75rem 0;
        }
        ul {
            padding-left: 1.4rem;
        }
        .ref-list {
            font-size: 0.9rem;
        }
    </style>
</head>
<body>
<h1>STEPS Technical Appendix</h1>
<p>
    This appendix explains how STEPS uses discrete choice experiment estimates, costing information
    and simple epidemiological multipliers to support decisions on scaling Field Epidemiology Training
    Programmes in India.
</p>

<h2>1. Discrete choice experiment and model specification</h2>
<p>
    The discrete choice experiment presented three options in each task: Training A, Training B and an opt out.
    Each training option was defined by programme type, trainee career incentives, mentorship intensity, mode
    of delivery, response capacity and cost per trainee per month. Training B and the reference levels form
    the baseline.
</p>
<p>
    The systematic part of utility for individual n, alternative j and task t is:
</p>
<div class="equation">
    U<sub>njt</sub> =
    α<sub>A,n</sub> ASC<sub>A,jt</sub> +
    α<sub>O,n</sub> ASC<sub>OptOut,jt</sub> +
    β<sub>1,n</sub> Intermediate<sub>jt</sub> +
    β<sub>2,n</sub> Advanced<sub>jt</sub> +
    β<sub>3,n</sub> UniQual<sub>jt</sub> +
    β<sub>4,n</sub> GovCareer<sub>jt</sub> +
    β<sub>5,n</sub> MentorMedium<sub>jt</sub> +
    β<sub>6,n</sub> MentorHigh<sub>jt</sub> +
    β<sub>7,n</sub> InPerson<sub>jt</sub> +
    β<sub>8,n</sub> Online<sub>jt</sub> +
    β<sub>9,n</sub> Resp15<sub>jt</sub> +
    β<sub>10,n</sub> Resp7<sub>jt</sub> +
    β<sub>11,n</sub> Cost<sub>njt</sub>.
</div>
<p>
    Cost is measured in thousands of rupees per trainee per month. Training B and the reference levels
    (Frontline, certificate, low mentorship, blended, response within 30 days) are omitted from the equation.
</p>

<h2>2. Mixed logit model and final estimates</h2>
<p>
    To allow for preference heterogeneity, a mixed logit model was estimated. Non cost coefficients follow
    independent normal distributions. The cost coefficient follows a log normal distribution:
</p>
<div class="equation">
    β<sub>11,n</sub> = -exp( μ<sub>cost</sub> + σ<sub>cost</sub> η<sub>n</sub> ), with η<sub>n</sub> ~ N(0,1),
</div>
<p>
    which ensures that higher cost always reduces utility.
</p>
<p>
    The main mixed logit results used in STEPS (mean parameters) are:
</p>
<ul>
    <li>ASC for Training A: 0.168.</li>
    <li>ASC for opt out: -0.601.</li>
    <li>Intermediate programme: 0.220; Advanced programme: 0.487.</li>
    <li>University qualification: 0.017; Government career pathway: -0.122.</li>
    <li>Mentorship medium: 0.453; mentorship high: 0.640.</li>
    <li>Fully in person delivery: -0.232; fully online delivery: -1.073.</li>
    <li>Response within 15 days: 0.546; within 7 days: 0.610.</li>
    <li>Mean cost coefficient: -0.005 per thousand rupees per trainee per month.</li>
</ul>
<p>
    In STEPS these values are stored in the mixed logit preference model and are used to derive endorsement
    probabilities and willingness to pay.
</p>

<h2>3. Latent class model and supportive group</h2>
<p>
    A two class latent class model distinguishes between training resisters and training supporters.
    STEPS uses the Class 2 parameters to represent supportive stakeholders.
</p>
<p>
    For Class 2, key estimates are:
</p>
<ul>
    <li>ASC for Training A: 0.098; ASC for opt out: -2.543.</li>
    <li>Advanced programme: 0.422.</li>
    <li>Mentorship medium and high: 0.342 and 0.486.</li>
    <li>Response within 15 and 7 days: 0.317 and 0.504.</li>
    <li>Cost coefficient: -0.001 per thousand rupees per trainee per month.</li>
</ul>
<p>
    Class 1 is interpreted as a training resister group with a positive opt out constant and a cost coefficient
    close to zero, implying very low responsiveness to cost. Because of this, willingness to pay in Class 1
    is imprecisely estimated and is not used for policy guidance in STEPS.
</p>

<h2>4. Willingness to pay examples</h2>
<p>
    For a DCE with a linear cost term, the willingness to pay for moving from the reference level to level k is:
</p>
<div class="equation">
    WTP<sub>k</sub> = - β<sub>k</sub> / β<sub>cost</sub>.
</div>
<p>
    For the mixed logit model, with mean cost coefficient -0.005, the main WTP estimates are:
</p>
<ul>
    <li>Intermediate programme: about 47,060 INR per trainee per month.</li>
    <li>Advanced programme: about 103,990 INR per trainee per month.</li>
    <li>Medium mentorship: about 96,870 INR per trainee per month.</li>
    <li>High mentorship: about 136,790 INR per trainee per month.</li>
    <li>Fully in person: about -49,560 INR per trainee per month.</li>
    <li>Fully online: about -229,330 INR per trainee per month.</li>
    <li>Response within 15 days: about 116,700 INR per trainee per month.</li>
    <li>Response within 7 days: about 130,460 INR per trainee per month.</li>
</ul>
<p>
    For Class 2 of the latent class model the cost coefficient is -0.001. For example, the implied WTP
    for Advanced training for supportive stakeholders is roughly 422,000 INR per trainee per month.
</p>

<h2>5. From model outputs to endorsement</h2>
<p>
    STEPS aggregates the relevant parameters into a single index for endorsement. For a given configuration,
    the difference in systematic utility between some FETP and no FETP is:
</p>
<div class="equation">
    ΔV = -α<sub>O</sub> + Σ β<sub>k</sub> x<sub>k</sub> + β<sub>cost</sub> · (C / 1000),
</div>
<p>
    where α<sub>O</sub> is the opt out constant, x<sub>k</sub> are the chosen attribute levels and C is the
    cost per trainee per month in rupees. The endorsement probability is:
</p>
<div class="equation">
    P(endorse) = exp(ΔV) / (1 + exp(ΔV)).
</div>
<p>
    In the Results tab this appears as “Endorse FETP option” and “Choose opt out”. A configuration that
    strongly improves attributes and keeps costs reasonable will have a high ΔV and therefore a high
    endorsement probability.
</p>

<h2>6. Cost templates and economic cost per cohort</h2>
<p>
    For each cost template, component totals are normalised to shares of total cost. Opportunity cost of
    trainee time is identified where present. For a given configuration, the programme cost per cohort is:
</p>
<div class="equation">
    C<sub>prog</sub> = CostPerTraineePerMonth × TraineesPerCohort × DurationMonths.
</div>
<p>
    This is allocated across components using template shares. If the opportunity cost toggle is on and the
    template includes an opportunity cost estimate, a separate opportunity cost term is added to obtain total
    economic cost per cohort.
</p>

<h3>Worked example: economic cost per cohort</h3>
<p>
    Suppose an Advanced programme is selected with 20 trainees, a duration of 24 months and a cost per trainee
    per month of 250,000 INR. The programme cost per cohort excluding opportunity cost is:
</p>
<div class="equation">
    C<sub>prog</sub> = 250,000 × 20 × 24 = 120,000,000 INR.
</div>
<p>
    If the chosen cost template indicates that 20 percent of total cost is opportunity cost of trainee time,
    then the economic cost per cohort becomes:
</p>
<div class="equation">
    C<sub>economic</sub> = C<sub>prog</sub> × (1 + 0.2) = 144,000,000 INR.
</div>
<p>
    In STEPS this is shown as “Total economic cost per cohort” in the Results tab and then scaled up in the
    National simulation tab by multiplying by the number of cohorts.
</p>

<h2>7. Epidemiological multipliers</h2>
<p>
    Epidemiological multipliers translate training outputs into simple public health metrics. For each tier,
    STEPS uses four multipliers:
</p>
<ul>
    <li>Graduates per cohort as a share of trainees.</li>
    <li>Outbreak responses per cohort per year.</li>
    <li>Value per additional graduate (INR).</li>
    <li>Value per outbreak response supported (INR).</li>
</ul>
<p>
    These multipliers can be adjusted in the Advanced settings panel or via the <code>epi_config.json</code>
    file. For example, the default settings for Advanced training assume that 95 percent of trainees graduate,
    each cohort supports roughly five outbreak responses per year, and each graduate and outbreak response
    is assigned an indicative monetary value.
</p>

<h3>Worked example: epidemiological benefit and benefit cost ratio</h3>
<p>
    Consider an Advanced programme with 30 trainees per cohort, 10 cohorts and an endorsement of 60 percent.
    With a graduation share of 0.95, the expected number of Advanced graduates nationally is:
</p>
<div class="equation">
    Graduates = 30 × 0.95 × 0.60 × 10 ≈ 171.
</div>
<p>
    If the value per Advanced graduate is set to 400,000 INR, the graduate component of benefits is about
    68.4 million INR. If each cohort supports five outbreak responses per year and the value per outbreak
    response is set to 4,000,000 INR, then the outbreak component per cohort is:
</p>
<div class="equation">
    5 × 4,000,000 = 20,000,000 INR.
</div>
<p>
    With ten cohorts this adds another 200,000,000 INR. Total indicative benefits are therefore roughly
    268.4 million INR. Comparing this with the total economic cost from the cost templates gives the net
    benefit and benefit cost ratio presented on the Results and National simulation tabs.
</p>

<h2>8. From per cohort to national results</h2>
<p>
    The National simulation tab multiplies per cohort costs and benefits by the number of cohorts selected
    in the Configuration tab. For example, if the economic cost per cohort is 144,000,000 INR and there are
    20 cohorts, total economic cost is:
</p>
<div class="equation">
    C<sub>national</sub> = 144,000,000 × 20 = 2,880,000,000 INR.
</div>
<p>
    The benefit cost ratio does not change when scaling up, but the net benefit and absolute magnitude
    of costs and benefits do. This provides a quick way to discuss national scale business cases.
</p>

<h2>9. Using advanced settings</h2>
<p>
    The Advanced settings panel exposes the key epidemiological multipliers and the display exchange rate.
    These settings are used as follows:
</p>
<ul>
    <li>The INR per USD field changes only the USD labels shown in the interface, not the underlying INR calculations.</li>
    <li>The graduates per cohort fields set the share of trainees that are treated as graduates in each tier.</li>
    <li>The outbreaks per cohort per year fields specify how many outbreak responses a typical cohort supports.</li>
    <li>The value per graduate and value per outbreak response fields determine how the epidemiological metrics
        are converted into monetary benefits.</li>
</ul>
<p>
    Country teams can start from the default values and update them to match new evidence or assumptions used
    in World Bank or Ministry of Health modelling. When advanced settings are changed, the Results and National
    simulation tabs update immediately.
</p>

<h3>Worked example: adjusting advanced settings</h3>
<p>
    Suppose India decides that the value per Advanced graduate should be 500,000 INR instead of 400,000 INR,
    and that Advanced cohorts now support on average six outbreak responses per year rather than five. These
    new values can be entered in the Advanced settings panel. When the user clicks “Apply advanced settings”,
    the indicative benefits and benefit cost ratios increase in line with the updated assumptions.
</p>

<h2>10. Recommended use</h2>
<p>
    STEPS is a decision aid, not a full transmission model. It focuses on preferences, costs and simple
    benefit indicators that can be explained quickly in policy settings. For major investments, results
    should be cross checked against detailed burden of disease or health security models.
</p>

<h2>11. Authorship and contact</h2>
<p>
    STEPS and this technical appendix were prepared by Mesfin Genie, Newcastle Business School, The University
    of Newcastle, Australia. For technical questions or requests to adapt the tool for other countries,
    please contact <a href="mailto:mesfin.genie@newcastle.edu.au">mesfin.genie@newcastle.edu.au</a>.
</p>
</body>
</html>
</script>

<script src="script.js"></script>
</body>
</html>
